{% extends "layout.html" %}
{% block content %}
<div>
  <h2 class="text-2xl font-bold mb-6">Parametrização</h2>

  <!-- Tabs para organizar as seções -->
  <div class="mb-6">
    <div class="border-b border-gray-200">
      <nav class="-mb-px flex space-x-8">
        <button id="tab-basicos" onclick="mostrarTab('basicos')" 
                class="tab-button active py-2 px-1 border-b-2 border-primary text-primary font-medium">
          Dados Básicos
        </button>
        <button id="tab-templates" onclick="mostrarTab('templates')" 
                class="tab-button py-2 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 font-medium">
          Templates do Sistema
        </button>
        <button id="tab-export-import" onclick="mostrarTab('export-import')" 
                class="tab-button py-2 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 font-medium">
          Export/Import
        </button>
      </nav>
    </div>
  </div>

  <!-- Seção de Dados Básicos -->
  <div id="content-basicos" class="tab-content space-y-4">
    
    <!-- Marcas -->
    <div class="bg-white border rounded-lg">
      <button class="w-full flex items-center justify-between p-4 text-left hover:bg-gray-50" 
              onclick="toggleSection('marcas')">
        <div class="flex items-center">
          <i class="fas fa-tag text-primary mr-3"></i>
          <span class="font-semibold text-lg">Marcas</span>
        </div>
        <i id="icon-marcas" class="fas fa-chevron-down text-gray-400 transition-transform"></i>
      </button>
      <div id="content-marcas" class="hidden border-t p-4">
        <form id="formMarca" class="flex gap-2 mb-4" aria-label="Cadastro de Marca">
          <input name="nome" required class="border rounded px-3 py-2 flex-1" placeholder="Nome da marca" />
          <button type="submit" class="bg-primary text-white px-4 py-2 rounded hover:bg-primary-dark">
            <i class="fas fa-plus mr-1"></i>Adicionar
          </button>
        </form>
        <div class="max-h-64 overflow-y-auto">
          <ul id="listaMarcas" class="space-y-1"></ul>
        </div>
        <div id="msgMarca" class="text-sm mt-3"></div>
      </div>
    </div>

    <!-- Operadoras -->
    <div class="bg-white border rounded-lg">
      <button class="w-full flex items-center justify-between p-4 text-left hover:bg-gray-50" 
              onclick="toggleSection('operadoras')">
        <div class="flex items-center">
          <i class="fas fa-signal text-primary mr-3"></i>
          <span class="font-semibold text-lg">Operadoras</span>
        </div>
        <i id="icon-operadoras" class="fas fa-chevron-down text-gray-400 transition-transform"></i>
      </button>
      <div id="content-operadoras" class="hidden border-t p-4">
        <form id="formOperadora" class="flex gap-2 mb-4" aria-label="Cadastro de Operadora">
          <input name="nome" required class="border rounded px-3 py-2 flex-1" placeholder="Nome da operadora" />
          <button type="submit" class="bg-primary text-white px-4 py-2 rounded hover:bg-primary-dark">
            <i class="fas fa-plus mr-1"></i>Adicionar
          </button>
        </form>
        <div class="max-h-64 overflow-y-auto">
          <ul id="listaOperadoras" class="space-y-1"></ul>
        </div>
        <div id="msgOperadora" class="text-sm mt-3"></div>
      </div>
    </div>

    <!-- Unidades de Negócio -->
    <div class="bg-white border rounded-lg">
      <button class="w-full flex items-center justify-between p-4 text-left hover:bg-gray-50" 
              onclick="toggleSection('unidades')">
        <div class="flex items-center">
          <i class="fas fa-building text-primary mr-3"></i>
          <span class="font-semibold text-lg">Unidades de Negócio</span>
        </div>
        <i id="icon-unidades" class="fas fa-chevron-down text-gray-400 transition-transform"></i>
      </button>
      <div id="content-unidades" class="hidden border-t p-4">
        <form id="formUnidade" class="flex gap-2 mb-4" aria-label="Cadastro de Unidade">
          <input name="nome" required class="border rounded px-3 py-2 flex-1" placeholder="Nome da unidade" />
          <button type="submit" class="bg-primary text-white px-4 py-2 rounded hover:bg-primary-dark">
            <i class="fas fa-plus mr-1"></i>Adicionar
          </button>
        </form>
        <div class="max-h-64 overflow-y-auto">
          <ul id="listaUnidades" class="space-y-1"></ul>
        </div>
        <div id="msgUnidade" class="text-sm mt-3"></div>
      </div>
    </div>

    <!-- Setores -->
    <div class="bg-white border rounded-lg">
      <button class="w-full flex items-center justify-between p-4 text-left hover:bg-gray-50" 
              onclick="toggleSection('setores')">
        <div class="flex items-center">
          <i class="fas fa-users text-primary mr-3"></i>
          <span class="font-semibold text-lg">Setores</span>
        </div>
        <i id="icon-setores" class="fas fa-chevron-down text-gray-400 transition-transform"></i>
      </button>
      <div id="content-setores" class="hidden border-t p-4">
        <form id="formSetor" class="space-y-3 mb-4" aria-label="Cadastro de Setor">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
            <input name="nome" required class="border rounded px-3 py-2" placeholder="Nome do setor" />
            <input name="email_responsavel" type="email" required 
                   class="border rounded px-3 py-2" placeholder="Email do responsável" />
          </div>
          <button type="submit" class="bg-primary text-white px-4 py-2 rounded hover:bg-primary-dark">
            <i class="fas fa-plus mr-1"></i>Adicionar
          </button>
        </form>
        <div class="max-h-64 overflow-y-auto">
          <ul id="listaSetores" class="space-y-1"></ul>
        </div>
        <div id="msgSetor" class="text-sm mt-3"></div>
      </div>
    </div>

  </div>

  <!-- Seção de Templates -->
  <div id="content-templates" class="tab-content hidden space-y-4">
    
    <!-- Termo para Smartphones -->
    <div class="bg-white border rounded-lg">
      <button class="w-full flex items-center justify-between p-4 text-left hover:bg-gray-50" 
              onclick="toggleSection('termo-smartphone')">
        <div class="flex items-center">
          <i class="fas fa-mobile-alt text-primary mr-3"></i>
          <div>
            <span class="font-semibold text-lg">Termo para Smartphones</span>
            <p class="text-sm text-slate-600 mt-1">Template específico para smartphones</p>
          </div>
        </div>
        <i id="icon-termo-smartphone" class="fas fa-chevron-down text-gray-400 transition-transform"></i>
      </button>
      <div id="content-termo-smartphone" class="hidden border-t p-4">
        <div class="mb-4">
          <label class="block text-sm font-medium text-slate-700 mb-2">Template HTML</label>
          <textarea id="termo_smartphone_template" 
                    class="w-full h-96 border border-slate-300 rounded-lg px-3 py-2 font-mono text-sm"
                    placeholder="Carregando template..."></textarea>
        </div>
        <div class="mb-4 p-3 bg-green-50 border border-green-200 rounded-lg">
          <p class="text-sm font-medium text-green-800 mb-2">Variáveis disponíveis:</p>
          <div class="space-y-3 text-xs text-green-700">
            <!-- Dados do Usuário -->
            <div>
              <p class="font-medium text-green-800 mb-1">Dados do Usuário:</p>
              <div class="grid grid-cols-1 md:grid-cols-2 gap-2">
                <div class="flex items-center">
                  <code class="bg-white px-2 py-1 rounded mr-2">&#123;&#123; NOME_USUARIO &#125;&#125;</code>
                  <span class="text-gray-600">Nome completo</span>
                </div>
                <div class="flex items-center">
                  <code class="bg-white px-2 py-1 rounded mr-2">&#123;&#123; CPF_USUARIO &#125;&#125;</code>
                  <span class="text-gray-600">CPF do colaborador</span>
                </div>
                <div class="flex items-center">
                  <code class="bg-white px-2 py-1 rounded mr-2">&#123;&#123; MATRICULA_USUARIO &#125;&#125;</code>
                  <span class="text-gray-600">Matrícula corporativa</span>
                </div>
              </div>
            </div>
            
            <!-- Dados do Equipamento -->
            <div>
              <p class="font-medium text-green-800 mb-1">Dados do Equipamento:</p>
              <div class="space-y-1">
                <div class="flex items-center">
                  <code class="bg-white px-2 py-1 rounded mr-2">&#123;&#123; DETALHES_EQUIPAMENTO &#125;&#125;</code>
                  <span class="text-gray-600">Descrição completa (marca, modelo, IMEI, série)</span>
                </div>
                <div class="flex items-center">
                  <code class="bg-white px-2 py-1 rounded mr-2">&#123;&#123; VALOR_EQUIPAMENTO &#125;&#125;</code>
                  <span class="text-gray-600">Valor do ativo (ex: "R$ 1.500,00" ou "Não informado")</span>
                </div>
                <div class="flex items-center">
                  <code class="bg-white px-2 py-1 rounded mr-2">&#123;&#123; ACESSORIOS &#125;&#125;</code>
                  <span class="text-gray-600">Acessórios do smartphone ("Não disponível" se vazio)</span>
                </div>
                <div class="flex items-center">
                  <code class="bg-white px-2 py-1 rounded mr-2">&#123;&#123; STATUS &#125;&#125;</code>
                  <span class="text-gray-600">Status do ativo (ex: "Novo", "Usado", "Em Manutenção")</span>
                </div>
              </div>
            </div>
            
          </div>
        </div>
        <div class="flex justify-end">
          <button onclick="salvarParametro('termo_smartphone_template')" 
                  class="px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/90">
            <i class="fa fa-save mr-2"></i>Salvar Template
          </button>
        </div>
      </div>
    </div>

    <!-- Termo para Notebooks/Desktops -->
    <div class="bg-white border rounded-lg">
      <button class="w-full flex items-center justify-between p-4 text-left hover:bg-gray-50" 
              onclick="toggleSection('termo-notebook')">
        <div class="flex items-center">
          <i class="fas fa-laptop text-primary mr-3"></i>
          <div>
            <span class="font-semibold text-lg">Termo para Notebooks/Desktops</span>
            <p class="text-sm text-slate-600 mt-1">Template específico para computadores</p>
          </div>
        </div>
        <i id="icon-termo-notebook" class="fas fa-chevron-down text-gray-400 transition-transform"></i>
      </button>
      <div id="content-termo-notebook" class="hidden border-t p-4">
        <div class="mb-4">
          <label class="block text-sm font-medium text-slate-700 mb-2">Template HTML</label>
          <textarea id="termo_notebook_template" 
                    class="w-full h-96 border border-slate-300 rounded-lg px-3 py-2 font-mono text-sm"
                    placeholder="Carregando template..."></textarea>
        </div>
        <div class="mb-4 p-3 bg-green-50 border border-green-200 rounded-lg">
          <p class="text-sm font-medium text-green-800 mb-2">Variáveis disponíveis:</p>
          <div class="space-y-3 text-xs text-green-700">
            <!-- Dados do Usuário -->
            <div>
              <p class="font-medium text-green-800 mb-1">Dados do Usuário:</p>
              <div class="grid grid-cols-1 md:grid-cols-2 gap-2">
                <div class="flex items-center">
                  <code class="bg-white px-2 py-1 rounded mr-2">&#123;&#123; NOME_USUARIO &#125;&#125;</code>
                  <span class="text-gray-600">Nome completo</span>
                </div>
                <div class="flex items-center">
                  <code class="bg-white px-2 py-1 rounded mr-2">&#123;&#123; CPF_USUARIO &#125;&#125;</code>
                  <span class="text-gray-600">CPF do colaborador</span>
                </div>
                <div class="flex items-center">
                  <code class="bg-white px-2 py-1 rounded mr-2">&#123;&#123; MATRICULA_USUARIO &#125;&#125;</code>
                  <span class="text-gray-600">Matrícula corporativa</span>
                </div>
              </div>
            </div>
            
            <!-- Dados do Equipamento -->
            <div>
              <p class="font-medium text-green-800 mb-1">Dados do Equipamento:</p>
              <div class="space-y-1">
                <div class="flex items-center">
                  <code class="bg-white px-2 py-1 rounded mr-2">&#123;&#123; DETALHES_EQUIPAMENTO &#125;&#125;</code>
                  <span class="text-gray-600">Descrição completa (marca, modelo, patrimônio)</span>
                </div>
                <div class="flex items-center">
                  <code class="bg-white px-2 py-1 rounded mr-2">&#123;&#123; VALOR_EQUIPAMENTO &#125;&#125;</code>
                  <span class="text-gray-600">Valor do ativo (ex: "R$ 1.500,00" ou "Não informado")</span>
                </div>
                <div class="flex items-center">
                  <code class="bg-white px-2 py-1 rounded mr-2">&#123;&#123; ACESSORIOS &#125;&#125;</code>
                  <span class="text-gray-600">Acessórios do computador ("Não disponível" se vazio)</span>
                </div>
                <div class="flex items-center">
                  <code class="bg-white px-2 py-1 rounded mr-2">&#123;&#123; STATUS &#125;&#125;</code>
                  <span class="text-gray-600">Status do ativo (ex: "Novo", "Usado", "Em Manutenção")</span>
                </div>
              </div>
            </div>
            
          </div>
        </div>
        <div class="flex justify-end">
          <button onclick="salvarParametro('termo_notebook_template')" 
                  class="px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/90">
            <i class="fa fa-save mr-2"></i>Salvar Template
          </button>
        </div>
      </div>
    </div>

    <!-- Termo para Chips SIM -->
    <div class="bg-white border rounded-lg">
      <button class="w-full flex items-center justify-between p-4 text-left hover:bg-gray-50" 
              onclick="toggleSection('termo-chip-sim')">
        <div class="flex items-center">
          <i class="fas fa-sim-card text-primary mr-3"></i>
          <div>
            <span class="font-semibold text-lg">Termo para Chips SIM</span>
            <p class="text-sm text-slate-600 mt-1">Template específico para chips SIM</p>
          </div>
        </div>
        <i id="icon-termo-chip-sim" class="fas fa-chevron-down text-gray-400 transition-transform"></i>
      </button>
      <div id="content-termo-chip-sim" class="hidden border-t p-4">
        <div class="mb-4">
          <label class="block text-sm font-medium text-slate-700 mb-2">Template HTML</label>
          <textarea id="termo_chip_sim_template" 
                    class="w-full h-96 border border-slate-300 rounded-lg px-3 py-2 font-mono text-sm"
                    placeholder="Carregando template..."></textarea>
        </div>
        <div class="mb-4 p-3 bg-green-50 border border-green-200 rounded-lg">
          <p class="text-sm font-medium text-green-800 mb-2">Variáveis disponíveis:</p>
          <div class="space-y-3 text-xs text-green-700">
            <!-- Dados do Usuário -->
            <div>
              <p class="font-medium text-green-800 mb-1">Dados do Usuário:</p>
              <div class="grid grid-cols-1 md:grid-cols-2 gap-2">
                <div class="flex items-center">
                  <code class="bg-white px-2 py-1 rounded mr-2">&#123;&#123; NOME_USUARIO &#125;&#125;</code>
                  <span class="text-gray-600">Nome completo</span>
                </div>
                <div class="flex items-center">
                  <code class="bg-white px-2 py-1 rounded mr-2">&#123;&#123; CPF_USUARIO &#125;&#125;</code>
                  <span class="text-gray-600">CPF do colaborador</span>
                </div>
                <div class="flex items-center">
                  <code class="bg-white px-2 py-1 rounded mr-2">&#123;&#123; MATRICULA_USUARIO &#125;&#125;</code>
                  <span class="text-gray-600">Matrícula corporativa</span>
                </div>
              </div>
            </div>
            
            <!-- Dados do Equipamento -->
            <div>
              <p class="font-medium text-green-800 mb-1">Dados do Chip:</p>
              <div class="space-y-1">
                <div class="flex items-center">
                  <code class="bg-white px-2 py-1 rounded mr-2">&#123;&#123; DETALHES_EQUIPAMENTO &#125;&#125;</code>
                  <span class="text-gray-600">Descrição completa (operadora, número com DDD, tipo)</span>
                </div>
                <div class="flex items-center">
                  <code class="bg-white px-2 py-1 rounded mr-2">&#123;&#123; VALOR_EQUIPAMENTO &#125;&#125;</code>
                  <span class="text-gray-600">Valor do ativo (ex: "R$ 1.500,00" ou "Não informado")</span>
                </div>
              </div>
            </div>
            
          </div>
        </div>
        <div class="flex justify-end">
          <button onclick="salvarParametro('termo_chip_sim_template')" 
                  class="px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/90">
            <i class="fa fa-save mr-2"></i>Salvar Template
          </button>
        </div>
      </div>
    </div>

    <!-- Email de Alocação -->
    <div class="bg-white border rounded-lg">
      <button class="w-full flex items-center justify-between p-4 text-left hover:bg-gray-50" 
              onclick="toggleSection('email-alocacao')">
        <div class="flex items-center">
          <i class="fas fa-envelope text-primary mr-3"></i>
          <div>
            <span class="font-semibold text-lg">Email de Alocação</span>
            <p class="text-sm text-slate-600 mt-1">Template de email enviado quando um ativo é alocado a um colaborador</p>
          </div>
        </div>
        <i id="icon-email-alocacao" class="fas fa-chevron-down text-gray-400 transition-transform"></i>
      </button>
      <div id="content-email-alocacao" class="hidden border-t p-4">
        <div class="space-y-4">
          <div>
            <label class="block text-sm font-medium text-slate-700 mb-2">Assunto do Email</label>
            <input type="text" id="email_alocacao_assunto" 
                   class="w-full border border-slate-300 rounded-lg px-3 py-2"
                   placeholder="Carregando...">
          </div>
          <div>
            <label class="block text-sm font-medium text-slate-700 mb-2">Corpo do Email</label>
            <textarea id="email_alocacao_corpo" 
                      class="w-full h-32 border border-slate-300 rounded-lg px-3 py-2"
                      placeholder="Carregando..."></textarea>
          </div>
          <div class="p-3 bg-blue-50 border border-blue-200 rounded-lg">
            <p class="text-sm font-medium text-blue-800 mb-2">Variáveis disponíveis:</p>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-2 text-xs text-blue-700">
              <code class="bg-white px-2 py-1 rounded">&#123;&#123; NOME_COLABORADOR &#125;&#125;</code>
              <code class="bg-white px-2 py-1 rounded">&#123;&#123; ATIVO_DESCRICAO &#125;&#125;</code>
              <code class="bg-white px-2 py-1 rounded">&#123;&#123; DATA_ALOCACAO &#125;&#125;</code>
            </div>
          </div>
          <div class="flex justify-end">
            <button onclick="salvarEmailAlocacao()" 
                    class="px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/90">
              <i class="fa fa-save mr-2"></i>Salvar Template
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Email de Devolução -->
    <div class="bg-white border rounded-lg">
      <button class="w-full flex items-center justify-between p-4 text-left hover:bg-gray-50" 
              onclick="toggleSection('email-devolucao')">
        <div class="flex items-center">
          <i class="fas fa-envelope-open text-primary mr-3"></i>
          <div>
            <span class="font-semibold text-lg">Email de Devolução</span>
            <p class="text-sm text-slate-600 mt-1">Template de email enviado quando um ativo é devolvido pelo colaborador</p>
          </div>
        </div>
        <i id="icon-email-devolucao" class="fas fa-chevron-down text-gray-400 transition-transform"></i>
      </button>
      <div id="content-email-devolucao" class="hidden border-t p-4">
        <div class="space-y-4">
          <div>
            <label class="block text-sm font-medium text-slate-700 mb-2">Assunto do Email</label>
            <input type="text" id="email_devolucao_assunto" 
                   class="w-full border border-slate-300 rounded-lg px-3 py-2"
                   placeholder="Carregando...">
          </div>
          <div>
            <label class="block text-sm font-medium text-slate-700 mb-2">Corpo do Email</label>
            <textarea id="email_devolucao_corpo" 
                      class="w-full h-32 border border-slate-300 rounded-lg px-3 py-2"
                      placeholder="Carregando..."></textarea>
          </div>
          <div class="p-3 bg-blue-50 border border-blue-200 rounded-lg">
            <p class="text-sm font-medium text-blue-800 mb-2">Variáveis disponíveis:</p>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-2 text-xs text-blue-700">
              <code class="bg-white px-2 py-1 rounded">&#123;&#123; NOME_COLABORADOR &#125;&#125;</code>
              <code class="bg-white px-2 py-1 rounded">&#123;&#123; ATIVO_DESCRICAO &#125;&#125;</code>
              <code class="bg-white px-2 py-1 rounded">&#123;&#123; DATA_DEVOLUCAO &#125;&#125;</code>
            </div>
          </div>
          <div class="flex justify-end">
            <button onclick="salvarEmailDevolucao()" 
                    class="px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/90">
              <i class="fa fa-save mr-2"></i>Salvar Template
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Documentação e Ajuda -->
    <div class="bg-white border rounded-lg">
      <button class="w-full flex items-center justify-between p-4 text-left hover:bg-gray-50" 
              onclick="toggleSection('documentacao')">
        <div class="flex items-center">
          <i class="fas fa-question-circle text-primary mr-3"></i>
          <div>
            <span class="font-semibold text-lg">Documentação e Ajuda</span>
            <p class="text-sm text-slate-600 mt-1">Exemplos de uso, dicas técnicas e referência completa das variáveis</p>
          </div>
        </div>
        <i id="icon-documentacao" class="fas fa-chevron-down text-gray-400 transition-transform"></i>
      </button>
      <div id="content-documentacao" class="hidden border-t p-4">
        <div class="space-y-6">
          
          <!-- Guia de Variáveis -->
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <!-- Variáveis do Termo -->
            <div class="p-4 bg-green-50 border border-green-200 rounded-lg">
              <h4 class="text-lg font-medium text-green-800 mb-3 flex items-center">
                <i class="fa fa-file-alt mr-2"></i>
                Termo de Responsabilidade
              </h4>
              <div class="space-y-2 text-sm">
                <div class="flex justify-between items-center">
                  <code class="bg-white px-2 py-1 rounded text-green-700 font-mono">&#123;&#123; NOME_USUARIO &#125;&#125;</code>
                  <span class="text-green-600 text-xs">Nome completo</span>
                </div>
                <div class="flex justify-between items-center">
                  <code class="bg-white px-2 py-1 rounded text-green-700 font-mono">&#123;&#123; CPF_USUARIO &#125;&#125;</code>
                  <span class="text-green-600 text-xs">CPF formatado</span>
                </div>
                <div class="flex justify-between items-center">
                  <code class="bg-white px-2 py-1 rounded text-green-700 font-mono">&#123;&#123; MATRICULA_USUARIO &#125;&#125;</code>
                  <span class="text-green-600 text-xs">Matrícula</span>
                </div>
                <div class="flex justify-between items-center">
                  <code class="bg-white px-2 py-1 rounded text-green-700 font-mono">&#123;&#123; DETALHES_EQUIPAMENTO &#125;&#125;</code>
                  <span class="text-green-600 text-xs">Descrição completa</span>
                </div>
                <div class="flex justify-between items-center">
                  <code class="bg-white px-2 py-1 rounded text-green-700 font-mono">&#123;&#123; VALOR_EQUIPAMENTO &#125;&#125;</code>
                  <span class="text-green-600 text-xs">Valor formatado do ativo</span>
                </div>
                <div class="flex justify-between items-center">
                  <code class="bg-white px-2 py-1 rounded text-green-700 font-mono">&#123;&#123; ACESSORIOS &#125;&#125;</code>
                  <span class="text-green-600 text-xs">Acessórios do ativo</span>
                </div>
                <div class="flex justify-between items-center">
                  <code class="bg-white px-2 py-1 rounded text-green-700 font-mono">&#123;&#123; STATUS &#125;&#125;</code>
                  <span class="text-green-600 text-xs">Status/Condição do ativo</span>
                </div>
              </div>
            </div>

            <!-- Variáveis dos Emails -->
            <div class="p-4 bg-blue-50 border border-blue-200 rounded-lg">
              <h4 class="text-lg font-medium text-blue-800 mb-3 flex items-center">
                <i class="fa fa-envelope mr-2"></i>
                Templates de Email
              </h4>
              <div class="space-y-2 text-sm">
                <div class="flex justify-between items-center">
                  <code class="bg-white px-2 py-1 rounded text-blue-700 font-mono">&#123;&#123; NOME_COLABORADOR &#125;&#125;</code>
                  <span class="text-blue-600 text-xs">Nome do colaborador</span>
                </div>
                <div class="flex justify-between items-center">
                  <code class="bg-white px-2 py-1 rounded text-blue-700 font-mono">&#123;&#123; ATIVO_DESCRICAO &#125;&#125;</code>
                  <span class="text-blue-600 text-xs">Descrição do ativo</span>
                </div>
                <div class="flex justify-between items-center">
                  <code class="bg-white px-2 py-1 rounded text-blue-700 font-mono">&#123;&#123; DATA_ALOCACAO &#125;&#125;</code>
                  <span class="text-blue-600 text-xs">Data da alocação</span>
                </div>
                <div class="flex justify-between items-center">
                  <code class="bg-white px-2 py-1 rounded text-blue-700 font-mono">&#123;&#123; DATA_DEVOLUCAO &#125;&#125;</code>
                  <span class="text-blue-600 text-xs">Data da devolução</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Exemplos de Uso -->
          <div class="p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
            <h5 class="font-medium text-yellow-800 mb-3 flex items-center">
              <i class="fa fa-lightbulb mr-2"></i>
              Exemplos de Uso
            </h5>
            <div class="space-y-3 text-sm text-yellow-800">
              <div>
                <strong>Termo HTML:</strong>
                <pre class="bg-white p-2 rounded mt-1 text-xs overflow-x-auto"><code>&lt;p&gt;Eu, &lt;strong&gt;&#123;&#123; NOME_USUARIO &#125;&#125;&lt;/strong&gt;, recebi o equipamento &#123;&#123; DETALHES_EQUIPAMENTO &#125;&#125;.&lt;/p&gt;</code></pre>
              </div>
              <div>
                <strong>Email de Alocação:</strong>
                <pre class="bg-white p-2 rounded mt-1 text-xs overflow-x-auto"><code>Olá &#123;&#123; NOME_COLABORADOR &#125;&#125;, o ativo &#123;&#123; ATIVO_DESCRICAO &#125;&#125; foi alocado para você em &#123;&#123; DATA_ALOCACAO &#125;&#125;.</code></pre>
              </div>
            </div>
          </div>

          <!-- Dicas Técnicas -->
          <div class="p-4 bg-slate-50 border border-slate-200 rounded-lg">
            <h5 class="font-medium text-slate-800 mb-3 flex items-center">
              <i class="fa fa-cog mr-2"></i>
              Dicas Técnicas
            </h5>
            <div class="text-sm text-slate-600 space-y-2">
              <div class="flex items-start">
                <i class="fa fa-check-circle text-green-500 mr-2 mt-0.5"></i>
                <span>Use <code class="bg-white px-1 rounded">&#123;&#123; &#125;&#125;</code> (duplas chaves) para delimitar as variáveis</span>
              </div>
              <div class="flex items-start">
                <i class="fa fa-check-circle text-green-500 mr-2 mt-0.5"></i>
                <span>No termo HTML, você pode usar tags HTML normalmente para formatação</span>
              </div>
              <div class="flex items-start">
                <i class="fa fa-check-circle text-green-500 mr-2 mt-0.5"></i>
                <span>Nos emails, use quebras de linha normais para formatação simples</span>
              </div>
              <div class="flex items-start">
                <i class="fa fa-check-circle text-green-500 mr-2 mt-0.5"></i>
                <span>As variáveis são substituídas automaticamente no momento do envio/geração</span>
              </div>
              <div class="flex items-start">
                <i class="fa fa-exclamation-triangle text-amber-500 mr-2 mt-0.5"></i>
                <span>Sempre teste os templates antes de usar em produção</span>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>

  </div>

  <!-- Seção de Export/Import -->
  <div id="content-export-import" class="tab-content hidden space-y-4">
    
    <!-- Exportação de Dados -->
    <div class="bg-white border rounded-lg">
      <button class="w-full flex items-center justify-between p-4 text-left hover:bg-gray-50" 
              onclick="toggleSection('exportacao')">
        <div class="flex items-center">
          <i class="fas fa-download text-primary mr-3"></i>
          <div>
            <span class="font-semibold text-lg">Exportação de Dados</span>
            <p class="text-sm text-slate-600 mt-1">Exporte dados do sistema para arquivos CSV</p>
          </div>
        </div>
        <i id="icon-exportacao" class="fas fa-chevron-down text-gray-400 transition-transform"></i>
      </button>
      <div id="content-exportacao" class="hidden border-t p-4">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          
          <!-- Exportar Estoque -->
          <div class="p-4 border border-slate-200 rounded-lg">
            <h4 class="font-medium text-slate-800 mb-3 flex items-center">
              <i class="fas fa-boxes text-blue-600 mr-2"></i>
              Exportar Estoque
            </h4>
            <p class="text-sm text-slate-600 mb-4">
              Exporta todos os ativos do sistema incluindo detalhes por tipo.
            </p>
            <button onclick="exportarAtivos()" 
                    class="w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center justify-center">
              <i class="fas fa-download mr-2"></i>
              Exportar Ativos
            </button>
            <div id="msg-export-ativos" class="text-sm mt-2"></div>
          </div>

          <!-- Exportar Usuários -->
          <div class="p-4 border border-slate-200 rounded-lg">
            <h4 class="font-medium text-slate-800 mb-3 flex items-center">
              <i class="fas fa-users text-green-600 mr-2"></i>
              Exportar Usuários
            </h4>
            <p class="text-sm text-slate-600 mb-4">
              Exporta todos os colaboradores do sistema com informações completas.
            </p>
            <button onclick="exportarColaboradores()" 
                    class="w-full px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center justify-center">
              <i class="fas fa-download mr-2"></i>
              Exportar Colaboradores
            </button>
            <div id="msg-export-colaboradores" class="text-sm mt-2"></div>
          </div>

        </div>
      </div>
    </div>

    <!-- Importação de Dados -->
    <div class="bg-white border rounded-lg">
      <button class="w-full flex items-center justify-between p-4 text-left hover:bg-gray-50" 
              onclick="toggleSection('importacao')">
        <div class="flex items-center">
          <i class="fas fa-upload text-primary mr-3"></i>
          <div>
            <span class="font-semibold text-lg">Importação de Dados</span>
            <p class="text-sm text-slate-600 mt-1">Importe dados em lote através de arquivos CSV</p>
          </div>
        </div>
        <i id="icon-importacao" class="fas fa-chevron-down text-gray-400 transition-transform"></i>
      </button>
      <div id="content-importacao" class="hidden border-t p-4">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          
          <!-- Importar Estoque -->
          <div class="p-4 border border-slate-200 rounded-lg">
            <h4 class="font-medium text-slate-800 mb-3 flex items-center">
              <i class="fas fa-boxes text-orange-600 mr-2"></i>
              Importar Estoque
            </h4>
            <p class="text-sm text-slate-600 mb-4">
              Importe ativos em lote usando arquivo CSV formatado.
            </p>
            <div class="space-y-3">
              <div>
                <label class="block text-sm font-medium text-slate-700 mb-2">Arquivo CSV</label>
                <input type="file" id="arquivo-ativos" accept=".csv" 
                       class="w-full border border-slate-300 rounded-lg px-3 py-2 text-sm">
              </div>
              <div class="flex gap-2">
                <button onclick="baixarExemploAtivos()" 
                        class="flex-1 px-3 py-2 text-sm bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 flex items-center justify-center">
                  <i class="fas fa-file-download mr-1"></i>
                  Baixar Exemplo
                </button>
                <button onclick="importarAtivos()" 
                        class="flex-1 px-3 py-2 text-sm bg-orange-600 text-white rounded-lg hover:bg-orange-700 flex items-center justify-center">
                  <i class="fas fa-upload mr-1"></i>
                  Importar
                </button>
              </div>
            </div>
            <div id="msg-import-ativos" class="text-sm mt-2"></div>
          </div>

          <!-- Importar Usuários -->
          <div class="p-4 border border-slate-200 rounded-lg">
            <h4 class="font-medium text-slate-800 mb-3 flex items-center">
              <i class="fas fa-users text-purple-600 mr-2"></i>
              Importar Usuários
            </h4>
            <p class="text-sm text-slate-600 mb-4">
              Importe colaboradores em lote usando arquivo CSV formatado.
            </p>
            <div class="space-y-3">
              <div>
                <label class="block text-sm font-medium text-slate-700 mb-2">Arquivo CSV</label>
                <input type="file" id="arquivo-colaboradores" accept=".csv" 
                       class="w-full border border-slate-300 rounded-lg px-3 py-2 text-sm">
              </div>
              <div class="flex gap-2">
                <button onclick="baixarExemploColaboradores()" 
                        class="flex-1 px-3 py-2 text-sm bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 flex items-center justify-center">
                  <i class="fas fa-file-download mr-1"></i>
                  Baixar Exemplo
                </button>
                <button onclick="importarColaboradores()" 
                        class="flex-1 px-3 py-2 text-sm bg-purple-600 text-white rounded-lg hover:bg-purple-700 flex items-center justify-center">
                  <i class="fas fa-upload mr-1"></i>
                  Importar
                </button>
              </div>
            </div>
            <div id="msg-import-colaboradores" class="text-sm mt-2"></div>
          </div>

        </div>
      </div>
    </div>

    <!-- Documentação de Importação -->
    <div class="bg-white border rounded-lg">
      <button class="w-full flex items-center justify-between p-4 text-left hover:bg-gray-50" 
              onclick="toggleSection('doc-importacao')">
        <div class="flex items-center">
          <i class="fas fa-info-circle text-primary mr-3"></i>
          <div>
            <span class="font-semibold text-lg">Documentação de Importação</span>
            <p class="text-sm text-slate-600 mt-1">Guia completo para formatação e uso dos arquivos CSV</p>
          </div>
        </div>
        <i id="icon-doc-importacao" class="fas fa-chevron-down text-gray-400 transition-transform"></i>
      </button>
      <div id="content-doc-importacao" class="hidden border-t p-4">
        <div class="space-y-6">
          
          <!-- Formato CSV Ativos -->
          <div class="p-4 bg-orange-50 border border-orange-200 rounded-lg">
            <h4 class="text-lg font-medium text-orange-800 mb-3 flex items-center">
              <i class="fas fa-boxes mr-2"></i>
              Formato CSV - Ativos
            </h4>
            <div class="space-y-3 text-sm">
              <p class="text-orange-700">
                <strong>Colunas obrigatórias:</strong> tipo, condicao, valor, unidade_negocio_id
              </p>
              <div class="bg-white p-3 rounded border text-xs font-mono overflow-x-auto">
                tipo,condicao,valor,unidade_negocio_id,marca_id,modelo,imei_slot,patrimonio,serie,numero,operadora_id,tipo_chip<br>
                smartphone,novo,1500.00,1,1,iPhone 13,123456789012345<br>
                notebook,usado,3000.00,1,3,Latitude 5520,,,PAT001,SN123456<br>
                desktop,novo,2500.00,1,3,OptiPlex 7090,,,PAT002,SN789012<br>
                chip_sim,novo,50.00,1,,,,,,21987654321,1,dados
              </div>
              <div class="grid grid-cols-1 md:grid-cols-2 gap-3 text-xs">
                <div>
                  <strong class="text-orange-800">Tipos válidos:</strong>
                  <ul class="list-disc list-inside ml-2 text-orange-700">
                    <li>smartphone</li>
                    <li>notebook</li>
                    <li>desktop</li>
                    <li>chip_sim</li>
                  </ul>
                </div>
                <div>
                  <strong class="text-orange-800">Condições válidas:</strong>
                  <ul class="list-disc list-inside ml-2 text-orange-700">
                    <li>novo</li>
                    <li>usado</li>
                    <li>danificado</li>
                    <li>em_manutencao</li>
                    <li>inativo</li>
                  </ul>
                </div>
              </div>
            </div>
          </div>

          <!-- Formato CSV Colaboradores -->
          <div class="p-4 bg-purple-50 border border-purple-200 rounded-lg">
            <h4 class="text-lg font-medium text-purple-800 mb-3 flex items-center">
              <i class="fas fa-users mr-2"></i>
              Formato CSV - Colaboradores
            </h4>
            <div class="space-y-3 text-sm">
              <p class="text-purple-700">
                <strong>Colunas obrigatórias:</strong> nome, email
              </p>
              <div class="bg-white p-3 rounded border text-xs font-mono overflow-x-auto">
                nome,email,matricula,cpf,cargo,setor_id,status<br>
                João Silva,joao@empresa.com,12345,123.456.789-00,Desenvolvedor,1,ativo<br>
                Maria Santos,maria@empresa.com,12346,987.654.321-00,Analista,2,ativo
              </div>
              <div class="grid grid-cols-1 md:grid-cols-2 gap-3 text-xs">
                <div>
                  <strong class="text-purple-800">Status válidos:</strong>
                  <ul class="list-disc list-inside ml-2 text-purple-700">
                    <li>ativo (padrão)</li>
                    <li>desligado</li>
                  </ul>
                </div>
                <div>
                  <strong class="text-purple-800">Formato CPF:</strong>
                  <div class="text-purple-700 ml-2 space-y-1">
                    <p>123.456.789-00 ou 12345678900</p>
                    <p><code class="bg-white px-1 rounded">000.000.000.00</code> = CPF não informado (aceita múltiplos)</p>
                  </div>
                </div>
                <div>
                  <strong class="text-purple-800">Matrículas especiais:</strong>
                  <div class="text-purple-700 ml-2">
                    <p><code class="bg-white px-1 rounded">0</code> ou <code class="bg-white px-1 rounded">1</code> = Matrícula não informada (aceita múltiplos)</p>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Observações Importantes -->
          <div class="p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
            <h5 class="font-medium text-yellow-800 mb-3 flex items-center">
              <i class="fas fa-exclamation-triangle mr-2"></i>
              Observações Importantes
            </h5>
            <div class="text-sm text-yellow-800 space-y-2">
              <div class="flex items-start">
                <i class="fas fa-check-circle text-green-500 mr-2 mt-0.5"></i>
                <span>O arquivo deve estar codificado em UTF-8</span>
              </div>
              <div class="flex items-start">
                <i class="fas fa-check-circle text-green-500 mr-2 mt-0.5"></i>
                <span>Use vírgula (,) como separador de campos</span>
              </div>
              <div class="flex items-start">
                <i class="fas fa-check-circle text-green-500 mr-2 mt-0.5"></i>
                <span>A primeira linha deve conter os cabeçalhos das colunas</span>
              </div>
              <div class="flex items-start">
                <i class="fas fa-info-circle text-blue-500 mr-2 mt-0.5"></i>
                <span>Campos não utilizados podem ficar em branco, mas mantenha as vírgulas separadoras</span>
              </div>
              <div class="flex items-start">
                <i class="fas fa-check-circle text-green-500 mr-2 mt-0.5"></i>
                <span>O sistema remove automaticamente caracteres invisíveis (como Zero Width Space)</span>
              </div>
              <div class="flex items-start">
                <i class="fas fa-exclamation-triangle text-amber-500 mr-2 mt-0.5"></i>
                <span>Registros duplicados serão ignorados</span>
              </div>
              <div class="flex items-start">
                <i class="fas fa-exclamation-triangle text-amber-500 mr-2 mt-0.5"></i>
                <span>Sempre faça backup antes de importar dados</span>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>

  </div>
</div>

<!-- Modal de Edição de Setor -->
<div id="modalEditarSetor" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
  <div class="bg-white rounded-lg p-6 w-full max-w-md mx-4">
    <div class="flex justify-between items-center mb-4">
      <h3 class="text-lg font-semibold">Editar Setor</h3>
      <button onclick="fecharModalSetor()" class="text-gray-500 hover:text-gray-700">
        <i class="fas fa-times"></i>
      </button>
    </div>
    <form id="formEditarSetor" class="space-y-4">
      <input type="hidden" id="editSetorId" />
      <div>
        <label class="block text-sm font-medium mb-1">Nome do Setor</label>
        <input id="editSetorNome" type="text" required 
               class="w-full border rounded px-3 py-2" placeholder="Nome do setor" />
      </div>
      <div>
        <label class="block text-sm font-medium mb-1">Email do Responsável</label>
        <input id="editSetorEmail" type="email" required 
               class="w-full border rounded px-3 py-2" placeholder="email@exemplo.com" />
      </div>
      <div class="flex gap-3 pt-2">
        <button type="button" onclick="fecharModalSetor()" 
                class="flex-1 px-4 py-2 text-gray-600 border border-gray-300 rounded hover:bg-gray-50">
          Cancelar
        </button>
        <button type="submit" 
                class="flex-1 px-4 py-2 bg-primary text-white rounded hover:bg-primary-dark">
          <i class="fas fa-save mr-1"></i>Salvar
        </button>
      </div>
    </form>
    <div id="msgEditarSetor" class="text-sm mt-2"></div>
  </div>
</div>

<!-- Loading overlay -->
<div id="loadingOverlay" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
  <div class="bg-white rounded-lg p-6 flex items-center">
    <i class="fa fa-spinner fa-spin text-primary text-xl mr-3"></i>
    <span>Salvando...</span>
  </div>
</div>
{% endblock %}
{% block scripts %}
<script>
// Função para alternar seções expansíveis
function toggleSection(sectionName) {
  const content = document.getElementById(`content-${sectionName}`);
  const icon = document.getElementById(`icon-${sectionName}`);
  
  if (content.classList.contains('hidden')) {
    content.classList.remove('hidden');
    icon.classList.add('rotate-180');
  } else {
    content.classList.add('hidden');
    icon.classList.remove('rotate-180');
  }
}

// Função para alternar tabs
function mostrarTab(tabName) {
  // Esconder todas as abas
  document.querySelectorAll('.tab-content').forEach(content => {
    content.classList.add('hidden');
  });
  
  // Remover classe active de todos os botões
  document.querySelectorAll('.tab-button').forEach(btn => {
    btn.classList.remove('active', 'border-primary', 'text-primary');
    btn.classList.add('border-transparent', 'text-gray-500');
  });
  
  // Mostrar aba selecionada
  document.getElementById(`content-${tabName}`).classList.remove('hidden');
  
  // Ativar botão selecionado
  const activeBtn = document.getElementById(`tab-${tabName}`);
  activeBtn.classList.add('active', 'border-primary', 'text-primary');
  activeBtn.classList.remove('border-transparent', 'text-gray-500');
}

// Funções para modal de edição de setor
function abrirModalSetor(id, nome, email) {
  document.getElementById('editSetorId').value = id;
  document.getElementById('editSetorNome').value = nome;
  document.getElementById('editSetorEmail').value = email;
  document.getElementById('msgEditarSetor').textContent = '';
  document.getElementById('modalEditarSetor').classList.remove('hidden');
}

function fecharModalSetor() {
  document.getElementById('modalEditarSetor').classList.add('hidden');
  document.getElementById('formEditarSetor').reset();
  document.getElementById('msgEditarSetor').textContent = '';
}
</script>
<script src="{{ url_for('static', filename='js/parametrizacao.js') }}"></script>
<script src="{{ url_for('static', filename='js/templates.js') }}"></script>
<script src="{{ url_for('static', filename='js/export-import.js') }}"></script>
{% endblock %}